---
title: "é´ã‚’ãªãã—ãŸã®ã§ã€ã‚¢ãƒ—ãƒªã‚’ä½œã‚‹ã“ã¨ã«ã—ãŸ vol1"
emoji: "ğŸˆ"
type: "idea" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["ReactNative", "Expo", "Deno", "TypeScript"]
published: true
---

## é´ã‚’ãªãã—ãŸ
ä»Šæ—¥ã€é´ã‚’ãªãã—ãŸã€‚é´ã‚’ãªãã—ãŸäººãŒèº«è¿‘ã«ã„ã‚‹äººãŒã©ã®ãã‚‰ã„ã„ã‚‹ã ã‚ã†ã‹ã€‚é´ãŒãªããªã£ãŸã“ã¨ã‚ˆã‚Šã‚‚ã€ãªãã—ã¦ã—ã¾ã£ãŸäº‹å®Ÿã«ãŒã£ã‹ã‚Šã—ã¦ã„ã‚‹ã€‚æµ·å¤–ã«ï¼“å›è¡Œã£ãŸã“ã¨ãŒã‚ã‚‹ãŒã€å…¨ã¦ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã‚’ç„¡ãã—ã¦ã„ã‚‹ã€‚å«ã‹ã‚‰è¨˜å¿µæ—¥ã«ã‚‚ã‚‰ã£ãŸãƒãƒƒã‚¯ãƒ¬ã‚¹ã‚‚ç„¡ãã—ãŸã€‚ãƒãƒƒã‚¯ãƒ¬ã‚¹ã‚’ç„¡ãã—ãŸæ™‚ã«ã€çµå©šæŒ‡è¼ªã‚’å¤–ã—ã¦ã€å«ã«é ã‘ãŸã€‚çµ¶å¯¾ã«ç„¡ãã™ã¨æ€ã£ãŸã‹ã‚‰ã€‚å…ˆé€±ã®æ±äº¬å‡ºå¼µã§ã€å«ãŒé å‡ºã™ã‚‹æ™‚ã«ã¯æŒ‡è¼ªã‚’ã¤ã‘ã¦ã„ã£ã¦æ¬²ã—ãŒã‚‹ã®ã§ã¤ã‘ã¦ã„ã£ãŸã€‚å¸°ã‚Šã®æ–°å¹¹ç·šã§ãªã‚“ã‹çª®å±ˆã«æ„Ÿã˜ã¦é„ã«ã—ã¾ã£ãŸã€‚ãã‚Œã‚’ä»Šæ€ã„å‡ºã—ã¦ã€æŒ‡è¼ªãŒãªããªã£ã¦ã„ãªã„ã“ã¨ã«å¿ƒåº•ã»ã£ã¨ã—ã¦ã„ã‚‹ã€‚

ãã‚‰ã„ã«åƒ•ã¯ç‰©å¿˜ã‚ŒãŒã²ã©ã„ã€‚è‡ªèº«ã‚’ ADHD ã¨ã„ã†äººãŒæœ€è¿‘å¤šãã¦ã€ãã‚“ãªã«è»½ã€…ã—ãã„ã†ã‚‚ã‚“ã˜ã‚ƒã­ãˆãã¨æ€ã£ã¦ã„ã‚‹ãŒã€åƒ•ã¯ãã†ã‹ã‚‚ã—ã‚Œãªã„ã€‚ã¡ãªã¿ã«ã€ ADHD è¨ºæ–­ã‚’ã—ã¦ã‚‚ã‚‰ã†ãŸã‚ã«ç—…é™¢ã‚’äºˆç´„ã—ãŸã“ã¨ã‚‚ã‚ã‚‹ãŒã€ãã‚Œã‚‚å¿˜ã‚Œã¦ã™ã£ã½ã‹ã—ã¦ã—ã¾ã£ãŸã€‚åƒ•è‡ªèº«ã¯ ADHD ã ã¨æ€ã£ã¦ã„ãªã„ãŒã€ç‰©å¿˜ã‚ŒãŒã²ã©ã„ã®ã¯äº‹å®Ÿã ã€‚

ãã—ã¦ã€åƒ•ã¯ 11 æœˆã«ãƒãƒªå³¶ã«è¡Œãã€‚ã—ã‹ã‚‚ä¸€äººã§ã€‚å‰å›ã‚¿ã‚¤ã«è¡Œã£ãŸæ™‚ã¯è²¡å¸ƒã¨ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã‚’ç„¡ãã—ãŸã€‚ã¤ã¾ã‚Šä»Šå›ã‚‚ä½•ã‹ç„¡ãã™å¯èƒ½æ€§ãŒã¨ã¦ã‚‚é«˜ã„ã€‚ã¨ã„ã†ã‹ã€ç„¡ãã™ã€‚çµ¶å¯¾ã«ã€‚

## ãã‚“ãªã‚ã‘ã§ã€ã‚¢ãƒ—ãƒªã‚’ä½œã‚‹ã“ã¨ã«ã—ãŸã‚ˆ
åƒ•ãŒæ¬²ã—ã„ã®ã¯ã€ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã‹ã‚‰ã€å®šæœŸçš„ã«ã‚‚ã®ã‚’ç„¡ãã—ã¦ã„ãªã„ã‹é€šçŸ¥ã—ã¦ãã‚Œã‚‹ã‚¢ãƒ—ãƒªã€‚é€šçŸ¥ã ã‘ã§ã„ã„ã€‚ãã‚Œã ã‘ã§å¤§ããé•ã†ã€‚åƒ•ã®çµŒé¨“ä¸Šã€ç„¡ãã—ã¦ã‹ã‚‰æ™‚é–“ãŒçµŒã¤ã»ã©ã€è¦‹ã¤ã‘ã‚‹ã®ãŒå›°é›£ã«ãªã‚‹ã€‚ã‚€ã—ã‚è‡ªåˆ†ãŒæ­©ã„ãŸé“ã¨ã‹æ€ã„å‡ºã›ãªã„ã€‚ç„¡ãã™ã®ã‚’é˜²ãã®ã§ã¯ãªãã¦ã€ç„¡ãã—ãŸæ™‚ã«è¦‹ã¤ã‹ã‚‹å¯èƒ½æ€§ã‚’é«˜ã‚ã‚‹ãŸã‚ã®ã‚¢ãƒ—ãƒªã§ã‚ã‚‹ã€‚

ã¡ãªã¿ã«ã‚¿ã‚¤ã§è²¡å¸ƒã‚’ç„¡ãã—ãŸæ™‚ã¯ã€ç„¡ãã—ã¦ã‹ã‚‰åŠæ—¥ä»¥ä¸ŠçµŒã£ã¦ã„ãŸã®ã§ã€è‡ªåˆ†ã®ç§»å‹•ã—ãŸå ´æ‰€ã‚’å…¨ã¦æ¢ã™ã®ã¯ä¸å¯èƒ½ã ã£ãŸã€‚å¥‡è·¡çš„ã«è¦‹ã¤ã‹ã£ãŸãŒ...ã€‚
https://note.com/katayama8000/n/n7508eb27b8a8

ã¡ãªã¿ã«ç„¡ãã™ã®ã‚’é˜²ãæ–¹æ³•ã‚‚è€ƒãˆãŸãŒã€çµæ§‹å³ã—ã„ã€‚åƒ•ãŒä½•ã‹è„³ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’ã—ã¦ã€ç‰©å¿˜ã‚Œã‚’æ”¹å–„ã™ã‚‹ãã‚‰ã„ã—ã‹ãªã„ã€‚ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã¯ã©ã†ã«ã‚‚ãªã‚‰ãªã„ã€‚åŒã˜ã‚ˆã†ãªæ–¹æ³•ã§ã€AirTag ã‚’å…¨ã¦ã®ã‚‚ã®ã«ã¤ã‘ã‚‹ã¨ã‹ã‚„ã‚Šã‚ˆã†ã¯ã‚ã‚‹ãŒã€ã‚ã‚“ã©ãã•ã„ä¸Šã«æ–™é‡‘ã‚‚åµ©ã‚€ã€‚

## ãªãœè¨˜äº‹ã‚’æ›¸ãã®ã‹
å€‹äººé–‹ç™ºã™ã‚‹ä¸Šã§ã€ä¸€ç•ªé¿ã‘ãªã‘ã‚Œã°ãªã‚‰ãªã„ã®ã¯ã€é€”ä¸­ã§è¾ã‚ã¦ã—ã¾ã†ã“ã¨ã§ã‚ã‚‹ã€‚ã›ã£ã‹ããƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªæ™‚é–“ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§å‹¿ä½“ãªã„ã€‚ãã®è¾ºã‚’ã¾ã¨ã‚ãŸè¨˜äº‹ã‚’éå»ã«æ›¸ã„ãŸã“ã¨ãŒã‚ã‚‹ã€‚

https://zenn.dev/doctormate/articles/app-for-wife34ixb5s

è¦‹ã¦ãã‚Œã‚‹äººãŒã„ã‚‹ã‹ã‚ã‹ã‚‰ãªã„ãŒã€é€²æ—ã‚’å…¬é–‹ã™ã‚‹ã“ã¨ã§ã€æŒ«æŠ˜ã™ã‚‹ç¢ºç‡ã‚’å°‘ã—ã§ã‚‚ä¸‹ã’ãŸã„ã€‚ãªãœ Zenn ã§æ›¸ãã®ã‹ã¨ã„ã†ã¨ã€æŠ€è¡“çš„ãªã“ã¨ã‚‚æ›¸ãã®ã§ã€‚ã‚ã¨åŸ·ç­†ã‚‚ã‚ã‚“ã©ãã•ã„ã®ã§ã€ã‚ã‚‹ç¨‹åº¦ github copilot ã®åŠ›ã‚‚å€Ÿã‚ŠãŸã‹ã£ãŸã‹ã‚‰ã€ä»Š VSCode ã‹ã‚‰æ›¸ã„ã¦ã‚‹ã£ã¦ã‚ã‘ã€‚ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ã‚’å‚ã‚Œæµã™ã‚ˆã†ãªè¨˜äº‹ã«ãªã‚‹ã‹ã‚‚ã—ã‚Œãªã„ãŒã€ãã“ã¯ã”å®¹èµ¦ã‚’ã€‚

ã‚ã¨ã¯ã€å‰²ã¨éç¨‹ã‚’è¦‹ã‚‹ã®ãŒå¥½ãã€‚ã€Œã“ã‚“ãªã‚¢ãƒ—ãƒªã‚’ä½œã‚Šã¾ã—ãŸï¼ã€ã¨ã„ã†è¨˜äº‹ã‚ˆã‚Šã‚‚ã€ã€Œã“ã‚“ãªã‚“ä½œã£ã¦ã¾ã™ã€œã€ã¨ã„ã†è¨˜äº‹ã®æ–¹ãŒããã‚‰ã‚Œã‚‹ã€‚

å…¨ 5 å›ãã‚‰ã„ã§çµ‚ã‚ã£ãŸã‚‰ã„ã„ãªã€‚

## ä»Šå›ã®ç›®æ¨™: Pushé€šçŸ¥å®šæœŸå®Ÿè¡Œã®æŠ€è¡“èª¿æŸ»
èª¿æŸ»ãŒå¿…è¦ãªã¨ã“ã‚ã¯å®šæœŸå®Ÿè¡Œã®é–“éš”ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ±ºã‚ã•ã›ã‚‹æ–¹æ³•ã§ã‚ã‚‹ã€‚Push é€šçŸ¥ã®æ–¹æ³•ã‚„ã€ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªã®ä½œã‚Šæ–¹ã¯å•é¡Œãªã„ã€‚éå»ã«å®Ÿè£…ã—ãŸã“ã¨ãŒã‚ã‚‹ã€‚

é€šå¸¸ã€å®šæœŸå®Ÿè¡Œã¯ cron ã‚’ä½¿ãˆã°è‰¯ã„ã€‚ã—ã‹ã—ã€ã“ã®å®šæœŸå®Ÿè¡Œã®é–“éš”ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ±ºã‚ã•ã›ãŸã„ã€‚é‡è¦ãªã‚‚ã®ã¯ 1 æ™‚é–“ãŠãã«ã€‚ãã†ã‚Œã»ã©ã§ã‚‚ãªã„ã‚‚ã®ã¯ 3 æ™‚é–“ãŠãã«ãªã©ã€‚ã‚ã¨ã¯å¤œã«é€šçŸ¥ã—ãªã„ã‚ˆã†ã«ã—ãŸã„ã€‚ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯æ—…è¡Œä¸­ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¨­å®šã—ãŸé–“éš”ã§ã€ã€Œâ—¯â—¯ã•ã‚“ã€è²¡å¸ƒç„¡ãã—ã¦ã„ãªã„ã§ã™ã‹ã€ã¨é€šçŸ¥ãŒæ¥ã‚‹æ„Ÿã˜ã ã€‚ã‚‚ã¡ã‚ã‚“æ—…è¡Œä¸­ã ã‘æœ‰åŠ¹ã«ã—ãŸã„ã€‚

ä»Šå›ã¯ã€cron ã‚’ä½¿ã£ã¦ã€Pushé€šçŸ¥ã‚’é€ã‚‹æ–¹æ³•ã¾ã§ã‚’èª¿æŸ»ã™ã‚‹ã€‚

### ä»Šå›ã®æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
èª¿æŸ»ã®å‰ã«ã€ä»Šè€ƒãˆã¦ã„ã‚‹æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã‚’æ›¸ã„ã¦ãŠãã€‚
- FE: `ReactNative` + `Expo`
- BE: `Deno` ãŒæœ‰åŠ›
- DB: æœªå®š (Deno ã¨ç›¸æ€§ãŒè‰¯ã•ãã†ãªã‚‚ã®)

é€šçŸ¥ã«ã¯ Expo ãŒ API ã‚’æä¾›ã—ã¦ã„ã‚‹ã®ã§ã€ãã‚Œã‚’ä½¿ã†ã€‚BE ã¯ä½•ã‚’ä½¿ã£ã¦ã‚‚è‰¯ã„ã®ã§ã€æœ¬å½“ã¯ Rust ã‚’ä½¿ã„ãŸã„ãŒã€ãƒ‡ãƒ—ãƒ­ã‚¤ãŒé¢å€’ã€‚Vercel ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã“ã¨ã‚ã‚‹ãŒã€cron ãŒ free plan ã ã¨ä½¿ã„ç‰©ã«ãªã‚‰ãªã„ã€‚ãƒ­ã‚°ãŒ 1 æ™‚é–“ã—ã‹æ®‹ã‚‰ãªã„ä¸Šã«ã€ä¸€æ—¥ä¸€å›ã—ã‹å®Ÿè¡Œã§ããªã„ã€‚Cloud Run + Cloud Scheduler ã ã¨ã»ã¼ç„¡æ–™ã§ä½¿ãˆã‚‹ãŒã€ã‚ã‚“ã©ãã•ã„ã€‚ã‚‚ã£ã¨æ¥½ã«è¨­å®šã—ãŸã„ã€‚ã£ã¦ã“ã¨ã§ã€Deno ã‚’ä½¿ã£ã¦ã¿ã‚‹ã€‚ã§ããªã‹ã£ãŸã‚‰ã€Google Cloud ã«é ¼ã‚‹ã€‚

ã¡ãªã¿ã«åƒ•ã¯ã€Rust ã® `expo-push-notification-client-rust` ã®ä½œè€…ãªã®ã§ã€æ°—è»½ã« Contribute ã—ã¦ã­ã€‚(å”çªãªå®£ä¼)
https://github.com/katayama8000/expo-push-notification-client-rust 

### Deno ã§ cron ã‚’ä½¿ã†æ–¹æ³•ã®èª¿æŸ»
å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¦‹ãªãŒã‚‰é€²ã‚ã¦ã„ãã€‚
OMGã€ã¨ã‚Šã‚ãˆãšã€web server ã‚’ç«‹ã¦ã¦ã€Deploy ã—ã¦ã‹ã‚‰ã€cron jobs ã§ãã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚ã†ã¨æ€ã£ãŸã‘ã©ã€å¿…è¦ãªã„ã‚‰ã—ã„ã€‚
>On Deno Deploy, our multi-tenant distributed serverless JavaScript platform, Deno.cron() is automatically detected and managed so you donâ€™t need to worry about anything.

> You can run cron jobs without a web server or even consistent incoming requests to keep your isolate alive. Thatâ€™s because whenever your project is deployed, Deno Deploy automatically detects your cron jobs and evaluates them. When its time for your handler to run, Deno Deploy automatically spins up an isolate on-demand to run them.

JSR ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œã£ãŸæ™‚ã‚‚æ€ã£ãŸãŒã€Deno ã™ã”ããªã„ã‹ã„ã€‚Node ã®çµ‚ç„‰ã‚‚è¿‘ã„ã‹ã‚‚ã€‚

```typescript
Deno.cron("Log a message", "* * * * *", () => {
    console.log("This will print once a minute.");
});
```
ã“ã‚Œã§ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã‚‰ã€å‹•ã„ã¦ã—ã¾ã£ãŸã€‚ã“ã‚ŒãŒèª¿æŸ»ã¨è¨€ãˆã‚‹ãŒã‚ã‹ã‚‰ã‚“ãŒã€Deno ã§ cron ã‚’ä½¿ãˆã‚‹ã“ã¨ã¯ã‚ã‹ã£ãŸã€‚

é †èª¿ã«é€²ã¿ã™ãã¦ã—ã¾ã£ãŸã®ã§ã€Deno ã® cron ã§ Push é€šçŸ¥ã‚’é€ã£ã¦ã¿ã‚‹ã€‚

### Deno ã§ Push é€šçŸ¥ã‚’é€ã‚‹æ–¹æ³•ã®èª¿æŸ»
ã¾ã‚ã€èª¿æŸ»ã¨ã„ã£ã¦ã‚‚ã€API ã‚’å©ãã ã‘ã§ã‚ã‚‹ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã¯ã¾ã ä½œã£ã¦ãªã„ã®ã§ã€token ãŒãªã„ãŒã€åƒ•ãŒå¦»ã®ãŸã‚ã«ä½œã£ãŸã‚¢ãƒ—ãƒªãŒã‚ã‚‹ã®ã§ã€ãã‚Œã§è©¦ã—ã¦ã¿ã‚‹ã€‚

```typescript
Deno.cron("Push notification", "* * * * *", async () => {
    console.log("This will push a message to your device every minute.");
    const pushMessage = {
        to: "ExponentPushToken[xxxxxxxxxxxxxxxxxxxxxx]",
        title: "hello",
        body: "world",
    };

    try {
        const response = await fetch("https://exp.host/--/api/v2/push/send", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(pushMessage),
        });

        if (!response.ok) {
            console.error(
                "Failed to send push notification:",
                response.statusText,
            );
        } else {
            console.log("Push notification sent successfully!");
        }
    } catch (error) {
        console.error("Error sending push notification:", error);
    }
});
```
å•é¡Œãªãå‹•ã„ãŸã€‚ã“ã‚Œã§ååˆ†ã ãŒã€Expo Server SDK ãŒã‚ã‚‹ã®ã§ã€npm package ã‚’ Deno ã‹ã‚‰ä½¿ã£ã¦ã¿ã‚‹ã€‚

```typescript
import { Expo } from "expo-server-sdk";

const expo = new Expo();

Deno.cron("Push notification", "* * * * *", async () => {
    const pushToken = "ExponentPushToken[xxxxxxxxxxxxxxxxxxxxxx]";

    if (!Expo.isExpoPushToken(pushToken)) {
        return;
    }

    const messages = [{
        to: pushToken,
        title: "hello",
        body: "world",
    }];

    try {
        const chunks = expo.chunkPushNotifications(messages);
        for (const chunk of chunks) {
            await expo.sendPushNotificationsAsync(chunk);
        }
    } catch (error) {
        console.error(error);
    }
});
```
é †èª¿ã«ã„ãã™ãã¦ã„ã‚‹ã€‚ã‚‚ã†åŠåˆ†ãã‚‰ã„çµ‚ã‚ã£ãŸæ°—åˆ†ã ã€‚
æ¬¡å›ã¯ã€DB or ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¨­å®šã—ãŸé–“éš”ã§é€šçŸ¥ã‚’é€ã‚‹æ–¹æ³•ã‚’èª¿æŸ»ã™ã‚‹ã€‚

ã¾ãŸã­:)
## References
https://deno.com/blog/cron
https://vercel.com/docs/cron-jobs/usage-and-pricing
https://github.com/expo/expo-server-sdk-node




